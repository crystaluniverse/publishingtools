import{S as t,i as s,s as e,G as a,a as o,A as n,z as r,d as l,f as c,j as p,q as i,r as m,B as u,C as h,n as g,e as d,m as f,c as b,b as $,o as P,h as k,p as j,u as v}from"./client.dcb07793.js";import{d as w,a as L}from"./_api.5f596b86.js";import"./showdown.20a62d9b.js";import{L as x}from"./ListPagination.cb5fc335.js";import{P as _}from"./PostList.fcecbbcb.js";function N(t){return{c:g,l:g,m:g,p:g,i:g,o:g,d:g}}function y(t){let s,e,a,n;const r=new _({props:{posts:t[10],username:t[3]}}),u=new x({props:{articlesCount:t[2],articlesPerPage:t[1].posts_per_page,objectPath:"/blog/"+t[3]+"/posts",page:t[4]}});return{c(){s=d("div"),f(r.$$.fragment),e=o(),a=d("div"),f(u.$$.fragment),this.h()},l(t){s=b(t,"DIV",{class:!0});var o=$(s);P(r.$$.fragment,o),o.forEach(l),e=c(t),a=b(t,"DIV",{class:!0});var n=$(a);P(u.$$.fragment,n),n.forEach(l),this.h()},h(){k(s,"class","row"),k(a,"class","row")},m(t,o){p(t,s,o),j(r,s,null),p(t,e,o),p(t,a,o),j(u,a,null),n=!0},p(t,s){const e={};1&s&&(e.posts=t[10]),8&s&&(e.username=t[3]),r.$set(e);const a={};4&s&&(a.articlesCount=t[2]),2&s&&(a.articlesPerPage=t[1].posts_per_page),8&s&&(a.objectPath="/blog/"+t[3]+"/posts"),16&s&&(a.page=t[4]),u.$set(a)},i(t){n||(i(r.$$.fragment,t),i(u.$$.fragment,t),n=!0)},o(t){m(r.$$.fragment,t),m(u.$$.fragment,t),n=!1},d(t){t&&l(s),v(r),t&&l(e),t&&l(a),v(u)}}}function q(t){return{c:g,l:g,m:g,p:g,i:g,o:g,d:g}}function C(t){let s,e,u,h,g={ctx:t,current:null,token:null,pending:q,then:y,catch:N,value:10,blocks:[,,,]};return a(u=t[0],g),{c(){s=o(),e=n(),g.block.c(),this.h()},l(t){r('[data-svelte="svelte-10h7psl"]',document.head).forEach(l),s=c(t),e=n(),g.block.l(t),this.h()},h(){document.title="Blog"},m(t,a){p(t,s,a),p(t,e,a),g.block.m(t,g.anchor=a),g.mount=(()=>e.parentNode),g.anchor=e,h=!0},p(s,[e]){if(t=s,g.ctx=t,1&e&&u!==(u=t[0])&&a(u,g));else{const s=t.slice();s[10]=g.resolved,g.block.p(s,e)}},i(t){h||(i(g.block),h=!0)},o(t){for(let t=0;t<3;t+=1){const s=g.blocks[t];m(s)}h=!1},d(t){t&&l(s),t&&l(e),g.block.d(t),g.token=null,g=null}}}async function E({host:t,path:s,params:e,query:a}){console.log("params in posts index",JSON.stringify(e));let o=parseInt(a.page);o||this.redirect(302,`${e.theuser}/posts?page=1`);let n=await w(e.theuser);o>0&&o--,console.log(n.length);let r=n.length;const l=await L(e.theuser);let c=l.posts_per_page||5,p=o*c,i=o*c+c;return{path:s,posts:n.slice(p,i),totalPostsLength:r,metadata:l}}function I(t,s,e){let a,{posts:o=[]}=s,{metadata:n}=s,{totalPostsLength:r}=s,{path:l}=s;const{preloading:c,page:p,session:i}=u();h(t,p,t=>e(7,a=t)),console.log("in posts index",a.params);let{username:m=a.params.theuser}=s,{pageNum:g=a.query.page}=s;return t.$set=(t=>{"posts"in t&&e(0,o=t.posts),"metadata"in t&&e(1,n=t.metadata),"totalPostsLength"in t&&e(2,r=t.totalPostsLength),"path"in t&&e(6,l=t.path),"username"in t&&e(3,m=t.username),"pageNum"in t&&e(4,g=t.pageNum)}),[o,n,r,m,g,p,l]}export default class extends t{constructor(t){super(),s(this,t,I,C,e,{posts:0,metadata:1,totalPostsLength:2,path:6,username:3,pageNum:4})}}export{E as preload};
